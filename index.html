<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Test de Opción Múltiple</title>
<style>
  /* Reset and base */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    margin: 0; padding: 0;
    color: #eee;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
  header {
    background-color: #1f2937;
    color: #60a5fa;
    padding: 1rem 2rem;
    text-align: center;
    box-shadow: 0 2px 8px rgb(0 0 0 / 0.8);
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    letter-spacing: 1px;
    color: #3b82f6;
  }
  main {
    flex-grow: 1;
    max-width: 720px;
    margin: 2rem auto;
    background: #1e293b;
    border-radius: 10px;
    padding: 1.5rem 2rem;
    box-shadow: 0 4px 20px rgb(0 0 0 / 0.7);
  }
  h2 {
    margin-top: 0;
    color: #60a5fa;
    font-weight: 600;
    border-bottom: 2px solid #3b82f6;
    padding-bottom: 0.25rem;
    margin-bottom: 1.5rem;
  }
  .question-container {
    margin-bottom: 2rem;
    border-bottom: 1px solid #334155;
    padding-bottom: 1rem;
  }
  .question-text {
    font-size: 1.15rem;
    margin-bottom: 0.6rem;
    font-weight: 700;
    color: #bfdbfe;
  }
  .options {
    list-style: none;
    padding-left: 0;
    margin-top: 0;
  }
  .options li {
    margin-bottom: 0.7rem;
  }
  input[type="radio"] {
    margin-right: 0.6rem;
    cursor: pointer;
    accent-color: #3b82f6;
    width: 18px;
    height: 18px;
    vertical-align: middle;
  }
  input[type="radio"]:disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }
  label {
    cursor: pointer;
    font-weight: 500;
    color: #e0e7ff;
    user-select: none;
    font-size: 1rem;
    line-height: 1.4;
  }
  label:has(input[type="radio"]:disabled) {
    cursor: not-allowed;
    opacity: 0.7;
  }
  button {
    background-color: #3b82f6;
    color: white;
    border: none;
    padding: 0.75rem 1.8rem;
    font-size: 1.15rem;
    border-radius: 7px;
    cursor: pointer;
    transition: background-color 0.3s ease-in-out, box-shadow 0.2s;
    font-weight: 700;
    box-shadow: 0 3px 8px rgb(59 130 246 / 0.6);
    user-select: none;
    outline-offset: 4px;
  }
  button:hover:not(:disabled), button:focus-visible:not(:disabled) {
    background-color: #2563eb;
    box-shadow: 0 5px 20px rgb(37 99 235 / 0.8);
    outline: none;
  }
  button:disabled {
    background-color: #4b5563;
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.6;
  }
  .result {
    background-color: #334155;
    border: 2px solid #3b82f6;
    border-radius: 10px;
    padding: 1.2rem 1.7rem;
    margin-top: 1.4rem;
    font-weight: 700;
    font-size: 1.3rem;
    color: #a5b4fc;
    text-align: center;
    user-select: text;
    box-shadow: 0 0 12px #3b82f6aa;
  }
  .answer-feedback {
    font-style: italic;
    font-size: 0.95rem;
    margin-top: 0.3rem;
    user-select: text;
  }
  .correct {
    color: #4ade80;
  }
  .incorrect {
    color: #f87171;
  }
  .footer {
    text-align: center;
    padding: 1rem;
    font-size: 0.9rem;
    color: #94a3b8;
    user-select: none;
    background: #1f2937;
    box-shadow: 0 -2px 8px rgb(0 0 0 / 0.7);
  }
  #start-section {
    text-align: center;
    padding: 2rem 0;
  }
  #start-section p {
    color: #94a3b8;
    font-size: 1.1rem;
    margin: 1rem 0;
  }
</style>
</head>
<body>
<header>
  <h1>Test de Opción Múltiple</h1>
</header>
<main>
  <section id="start-section">
    <h2>Preparado para comenzar el test?</h2>
    <p>Tienes 2 minutos para responder todas las preguntas.</p>
    <button id="start-btn">Iniciar Test</button>
  </section>
  <section id="test-section" style="display:none;">
    <div id="timer" style="display:none; text-align: center; font-size: 1.5rem; color: #60a5fa; margin: 1rem 0; font-weight: bold;"></div>
    <h2>Realiza el Test</h2>
    <form id="test-form"></form>
    <button id="submit-test" style="display:none;">Enviar respuestas</button>
    <div id="result-container"></div>
    <button id="restart" style="display:none; margin-top:1rem;">Reiniciar</button>
  </section>
</main>
<footer class="footer">
  &copy; 2024 Test Personalizable
</footer>
<script>
  (function() {
    const startSection = document.getElementById('start-section');
    const testSection = document.getElementById('test-section');
    const startBtn = document.getElementById('start-btn');
    const testForm = document.getElementById('test-form');
    const submitTestBtn = document.getElementById('submit-test');
    const resultContainer = document.getElementById('result-container');
    const restartBtn = document.getElementById('restart');
    const timer = document.getElementById('timer');

    let timerInterval;
    let timeLeft = 120;

    // Preguntas definidas 
    const questionsData = [
      {
        question: "¿En que año terminó de disolverse Yugoslavia?",
        options: ["2003", "2006", "1991", "1998"],
        answer: 1
      },
      {
        question: "¿Kosovo es un país?",
        options: ["si", "no", "sigue en disputa"],
        answer: 2
      },
       {
        question: "¿Por que fue importante Tito?",
        options: ["ayudó a la conformacióm de una identidad nacional", "usó el capitalismo para unificar el país"],
        answer: 0
      },
       {
        question: "Yugoslavia se dividió de forma pacífica",
        options: ["Verdadero", "falso"],
        answer: 1
      },
       {
        question: "¿Fue Serbia el país mas conflictivo?",
        options: ["Si", "No"],
        answer: 0
      },
       {
        question: "Seleccionar los países que no tuvieron guerras por su independencia",
        options: ["Solo Croacia", "Bosnia y Eslovenia", "Eslovenia y Croacia", "Solo Macedonia"],
        answer: 3
      },
       {
        question: "¿Alguna persona luego de Tito pudo sostener la política yugoslava?",
        options: ["Si", "No"],
        answer: 1
      },
    ];

    // Crear elementos con atributos (helper)
    function createElement(type, attrs = {}, ...children) {
      const el = document.createElement(type);
      for(const key in attrs) {
        if(key === 'className') el.className = attrs[key];
        else if (key.startsWith('aria')) el.setAttribute(key, attrs[key]);
        else if(key === 'htmlFor') el.htmlFor = attrs[key];
        else el[key] = attrs[key];
      }
      for(const child of children) {
        if (typeof child === 'string') {
          el.appendChild(document.createTextNode(child));
        } else if (child instanceof Node) {
          el.appendChild(child);
        }
      }
      return el;
    }

    // Actualizar display del timer
    function updateTimerDisplay() {
      const mins = Math.floor(timeLeft / 60);
      const secs = timeLeft % 60;
      timer.textContent = `Tiempo restante: ${mins}:${secs.toString().padStart(2, '0')}`;
      if (timeLeft <= 10) {
        timer.style.color = '#f87171'; // Rojo si queda poco tiempo
      }
    }

    // Iniciar timer
    function startTimer() {
      timer.style.display = 'block';
      timeLeft = 90;
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          // Deshabilitar formulario
          const radios = testForm.querySelectorAll('input[type="radio"]');
          radios.forEach(r => r.disabled = true);
          submitTestBtn.disabled = true;
          // Auto-submit sin verificar completitud
          const formData = new FormData(testForm);
          showResults(formData);
        }
      }, 1000);
    }

    // Construir formulario del test
    function buildTestForm(questions) {
      testForm.innerHTML = ''; // reset
      resultContainer.innerHTML = '';
      submitTestBtn.style.display = 'inline-block';
      restartBtn.style.display = 'none';
      submitTestBtn.disabled = false;

      questions.forEach((q, i) => {
        const container = createElement('div', {className:'question-container'});

        const qText = createElement('div', {className:'question-text'}, `${i+1}. ${q.question}`);
        container.appendChild(qText);

        const ul = createElement('ul', {className:'options'});

        q.options.forEach((opt, idx) => {
          const optionId = `q${i}_opt${idx}`;
          const li = createElement('li');
          const label = createElement('label', {htmlFor: optionId});
          const radio = createElement('input', {
            type: 'radio',
            name: `question${i}`,
            id: optionId,
            value: idx,
            required: true
          });
          label.appendChild(radio);
          label.appendChild(document.createTextNode(opt));
          li.appendChild(label);
          ul.appendChild(li);
        });

        container.appendChild(ul);
        testForm.appendChild(container);
      });
    }

    // Mostrar resultados
    function showResults(answers) {
      let correctCount = 0;
      resultContainer.innerHTML = '';
      submitTestBtn.style.display = 'none';
      restartBtn.style.display = 'inline-block';

      questionsData.forEach((q,i) => {
        const userAnswer = answers.get(`question${i}`);
        const isCorrect = userAnswer !== undefined && Number(userAnswer) === q.answer;
        if(isCorrect) correctCount++;

        const container = createElement('div', {className:'question-container'});
        const qText = createElement('div', {className:'question-text'}, `${i+1}. ${q.question}`);
        container.appendChild(qText);

        const feedback = createElement('div', {className: 'answer-feedback ' + (isCorrect ? 'correct' : 'incorrect')});
        if (userAnswer === undefined) {
          feedback.textContent = `No respondida ❌. Respuesta correcta: "${q.options[q.answer]}"`;
        } else if(isCorrect) {
          feedback.textContent = `Correcto ✅`;
        } else {
          feedback.textContent = `Incorrecto ❌. Respuesta correcta: "${q.options[q.answer]}"`;
        }
        container.appendChild(feedback);
        resultContainer.appendChild(container);
      });

      const summary = createElement('div', {className:'result'}, `Has respondido correctamente ${correctCount} de ${questionsData.length} preguntas.`);
      resultContainer.insertBefore(summary, resultContainer.firstChild);
    }

    // Evento para botón de inicio
    startBtn.addEventListener('click', () => {
      startSection.style.display = 'none';
      testSection.style.display = 'block';
      buildTestForm(questionsData);
      startTimer();
    });

    // Evento para enviar (verifica completitud solo si no ha terminado el tiempo)
    submitTestBtn.addEventListener('click', () => {
      if (submitTestBtn.disabled) return;
      const formData = new FormData(testForm);

      // Verificar que todas las preguntas tienen respuesta (solo para submit manual)
      for(let i=0; i<questionsData.length; i++) {
        if(!formData.has(`question${i}`)) {
          alert(`Por favor responde la pregunta ${i+1}.`);
          return;
        }
      }
      showResults(formData);
    });

    // Evento para reiniciar (vuelve al inicio)
    restartBtn.addEventListener('click', () => {
      if (timerInterval) clearInterval(timerInterval);
      startSection.style.display = 'block';
      testSection.style.display = 'none';
      timer.style.display = 'none';
      resultContainer.innerHTML = '';
      testForm.innerHTML = '';
    });
  })();
</script>
</body>
</html>
